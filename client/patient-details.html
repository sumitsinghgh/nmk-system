<!doctype html>
<html>
  <head>
    <title>Patient Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #eef2f7, #f1f5f9);
        font-family: "Segoe UI", sans-serif;
        min-height: 100vh;
      }

      /* Main Card Container */
      .card {
        border: none;
        border-radius: 22px;
        background: #ffffff;
        box-shadow: 0 18px 45px rgba(0, 0, 0, 0.07);
        padding: 35px;
        max-width: 1200px;
        margin: auto;
        animation: fadeIn 0.4s ease-in-out;
      }

      /* Section Heading */
      .section-title {
        font-size: 19px;
        font-weight: 600;
        margin-top: 40px;
        margin-bottom: 22px;
        color: #0f172a;
        border-left: 5px solid #2563eb;
        padding-left: 14px;
      }

      /* Info Card Base */
      .info-box {
        padding: 18px;
        border-radius: 16px;
        margin-bottom: 22px; /* üî• spacing fix */
        border: 1px solid rgba(0, 0, 0, 0.05);
        transition: 0.25s ease-in-out;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.04);
      }

      /* üîµ Basic Section */
      .basic-box {
        background: linear-gradient(135deg, #bfdbfe, #60a5fa);
      }

      /* üü¢ Financial Section */
      .financial-box {
        background: linear-gradient(135deg, #86efac, #22c55e);
      }

      /* üü£ Additional Section */
      .additional-box {
        background: linear-gradient(135deg, #d8b4fe, #a855f7);
      }

      /* Hover effect */
      .info-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
      }

      /* Labels */
      .label {
        font-size: 12px;
        color: rgba(15, 23, 42, 0.7);
        text-transform: uppercase;
        letter-spacing: 0.6px;
      }

      /* Values */
      .value {
        font-size: 17px;
        font-weight: 600;
        color: #0f172a;
        margin-top: 6px;
      }

      .status-admitted {
        background: #22c55e;
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      .status-discharged {
        background: #ef4444;
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      /* Back Button */
      .back-btn {
        border-radius: 14px;
        padding: 7px 16px;
        font-weight: 500;
      }

      /* Fade animation */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(15px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <button class="btn btn-secondary mb-3" onclick="goBack()">‚Üê Back</button>

      <div class="card shadow p-4">
        <h3 class="mb-4">Patient Full Details</h3>

        <div id="patientData"></div>
      </div>
    </div>

    <script>
      const API = "https://nmk-system.onrender.com";
      const token = localStorage.getItem("token");

      const params = new URLSearchParams(window.location.search);
      const patientId = params.get("id");

      if (!token) {
        window.location.href = "index.html";
      }

      async function loadPatientDetails() {
        const response = await fetch(API + "/patients/" + patientId, {
          headers: {
            Authorization: "Bearer " + token,
          },
        });

        const data = await response.json();

        if (!response.ok) {
          alert("Patient not found");
          window.location.href = "patients.html";
          return;
        }
        document.getElementById("patientData").innerHTML = `

        <h5 class="section-title">Basic Information</h5>
        <div class="row g-4">

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Patient ID</div>
              <div class="value">${data.ID ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Name</div>
              <div class="value">${data.Name ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Guardian</div>
              <div class="value">${data.Guardian ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Mobile</div>
              <div class="value">${data.Mobile ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Admission Date</div>
              <div class="value">${data.AdmissionDate ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box basic-box">
              <div class="label">Duration</div>
              <div class="value">${data.Months} Months, ${data.Days} Days</div>
            </div>
          </div>

        </div>


        <h5 class="section-title">Financial Details</h5>
        <div class="row g-4">

          <div class="col-md-4">
            <div class="info-box financial-box">
              <div class="label">Total Fees</div>
              <div class="value">‚Çπ${data.TotalFees ?? 0}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box financial-box">
              <div class="label">Paid Amount</div>
              <div class="value">‚Çπ${data.PaidAmount ?? 0}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box financial-box">
              <div class="label">Balance</div>
              <div class="value">‚Çπ${data.Balance ?? 0}</div>
            </div>
          </div>

        </div>


        <h5 class="section-title">Additional Details</h5>
        <div class="row g-4">

          <div class="col-md-4">
            <div class="info-box additional-box">
              <div class="label">Addiction Type</div>
              <div class="value">${data.AddictionType ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box additional-box">
              <div class="label">Pickup Type</div>
              <div class="value">${data.PickupType ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box additional-box">
              <div class="label">Distance (KM)</div>
              <div class="value">${data.DistanceKM ?? "-"}</div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box additional-box">
              <div class="label">Status</div>
              <div class="value">
                <span class="${
                  data.Status === "Admitted"
                    ? "status-admitted"
                    : "status-discharged"
                }">
                  ${data.Status ?? "-"}
                </span>
              </div>
            </div>
          </div>

        </div>

        `;
      }

      function goBack() {
        window.location.href = "patients.html";
      }

      loadPatientDetails();
    </script>
  </body>
</html>
