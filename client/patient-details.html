<!doctype html>
<html>
  <head>
    <title>Patient Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #eef2f7, #f1f5f9);
        font-family: "Segoe UI", sans-serif;
        min-height: 100vh;
      }

      .card {
        border: none;
        border-radius: 20px;
        background: #ffffff;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.06);
        padding: 30px;
      }

      /* Section Heading */
      .section-title {
        font-size: 19px;
        font-weight: 600;
        margin-top: 35px;
        margin-bottom: 18px;
        color: #0f172a;
        border-left: 4px solid #2563eb;
        padding-left: 12px;
      }

      /* Info Card */
      .info-box {
        background: linear-gradient(135deg, #f8fafc, #eef2ff);
        padding: 15px;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        transition: 0.25s ease-in-out;
      }
      .basic-box {
        background: linear-gradient(135deg, #f8fafc, #e0f2fe);
      }

      .financial-box {
        background: linear-gradient(135deg, #f0fdf4, #dcfce7);
      }

      .additional-box {
        background: linear-gradient(135deg, #faf5ff, #f3e8ff);
      }
      .info-box:hover {
        background: linear-gradient(135deg, #e0f2fe, #dbeafe);
        transform: translateY(-3px);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      }

      .label {
        font-size: 12px;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .value {
        font-size: 17px;
        font-weight: 600;
        color: #0f172a;
        margin-top: 4px;
      }

      /* Financial Highlight */
      .financial-highlight {
        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
        border: 1px solid #bae6fd;
      }

      /* Status Badge */
      .status-active {
        background: #dcfce7;
        color: #166534;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      .status-deleted {
        background: #fee2e2;
        color: #991b1b;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      /* Back Button */
      .back-btn {
        border-radius: 12px;
        padding: 6px 14px;
        font-weight: 500;
      }

      /* Smooth fade animation */
      .card {
        animation: fadeIn 0.4s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <button class="btn btn-secondary mb-3" onclick="goBack()">← Back</button>

      <div class="card shadow p-4">
        <h3 class="mb-4">Patient Full Details</h3>

        <div id="patientData"></div>
      </div>
    </div>

    <script>
      const API = "https://nmk-system.onrender.com";
      const token = localStorage.getItem("token");

      const params = new URLSearchParams(window.location.search);
      const patientId = params.get("id");

      if (!token) {
        window.location.href = "index.html";
      }

      async function loadPatientDetails() {
        const response = await fetch(API + "/patients/" + patientId, {
          headers: {
            Authorization: "Bearer " + token,
          },
        });

        const data = await response.json();

        if (!response.ok) {
          alert("Patient not found");
          window.location.href = "patients.html";
          return;
        }
        document.getElementById("patientData").innerHTML = `

        <h5 class="section-title">Basic Information</h5>
        <div class="row">
          <div class="col-md-4">
            <div class="info-box basic-box">
              <small class="text-muted">Patient ID</small>
              <div><strong>${data.ID ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Name</small>
              <div><strong>${data.Name ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Guardian</small>
              <div><strong>${data.Guardian ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Mobile</small>
              <div><strong>${data.Mobile ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Admission Date</small>
              <div><strong>${data.AdmissionDate ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Duration</small>
              <div><strong>${data.Months} Months, ${data.Days} Days</strong></div>
            </div>
          </div>
        </div>

        <h5 class="section-title">Financial Details</h5>
        <div class="row">
          <div class="col-md-4">
            <div class="info-box financial-box">
              <small class="text-muted">Total Fees</small>
              <div><strong>₹${data.TotalFees ?? 0}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Paid Amount</small>
              <div><strong>₹${data.PaidAmount ?? 0}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Balance</small>
              <div><strong>₹${data.Balance ?? 0}</strong></div>
            </div>
          </div>
        </div>

        <h5 class="section-title">Additional Details</h5>
        <div class="row">
          <div class="col-md-4">
            <div class="info-box additional-box">
              <small class="text-muted">Addiction Type</small>
              <div><strong>${data.AddictionType ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Pickup Type</small>
              <div><strong>${data.PickupType ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Distance (KM)</small>
              <div><strong>${data.DistanceKM ?? "-"}</strong></div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="info-box">
              <small class="text-muted">Status</small>
              <div>
                <span class="status-badge ${
                  data.Status === "Active" ? "status-active" : "status-deleted"
                }">
                  ${data.Status ?? "-"}
                </span>
              </div>
            </div>
          </div>
        </div>
        `;
      }

      function goBack() {
        window.location.href = "patients.html";
      }

      loadPatientDetails();
    </script>
  </body>
</html>
