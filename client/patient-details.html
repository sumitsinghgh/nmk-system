<!doctype html>
<html>
  <head>
    <title>Patient Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #eef2f7, #f8fafc);
        font-family: "Segoe UI", sans-serif;
      }

      .card {
        border: none;
        border-radius: 18px;
        background: #ffffff;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      }

      .section-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 20px;
        color: #1e293b;
      }

      .info-box {
        background: #f8fafc;
        padding: 15px;
        border-radius: 12px;
        transition: 0.2s ease-in-out;
      }

      .info-box:hover {
        background: #e2e8f0;
        transform: translateY(-2px);
      }

      .label {
        font-size: 13px;
        color: #64748b;
      }

      .value {
        font-size: 16px;
        font-weight: 600;
        color: #1e293b;
      }

      .status-active {
        background: #dcfce7;
        color: #166534;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      .back-btn {
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <button class="btn btn-secondary mb-3" onclick="goBack()">← Back</button>

      <div class="card shadow p-4">
        <h3 class="mb-4">Patient Full Details</h3>

        <div id="patientData"></div>
      </div>
    </div>

    <script>
      const API = "https://nmk-system.onrender.com";
      const token = localStorage.getItem("token");

      const params = new URLSearchParams(window.location.search);
      const patientId = params.get("id");

      if (!token) {
        window.location.href = "index.html";
      }

      async function loadPatientDetails() {
        const response = await fetch(API + "/patients/" + patientId, {
          headers: {
            Authorization: "Bearer " + token,
          },
        });

        const data = await response.json();

        if (!response.ok) {
          alert("Patient not found");
          window.location.href = "patients.html";
          return;
        }
        document.getElementById("patientData").innerHTML = `
          <div class="section-title">Basic Information</div>
          <div class="row g-3 mb-4">

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Patient ID</div>
                <div class="value">${data.ID ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Name</div>
                <div class="value">${data.Name ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Guardian</div>
                <div class="value">${data.Guardian ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Mobile</div>
                <div class="value">${data.Mobile ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Admission Date</div>
                <div class="value">${data.AdmissionDate ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Duration</div>
                <div class="value">${data.Months ?? 0} Months, ${data.Days ?? 0} Days</div>
              </div>
            </div>

          </div>

          <div class="section-title">Financial Details</div>
          <div class="row g-3 mb-4">

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Total Fees</div>
                <div class="value">₹${data.TotalFees ?? 0}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Paid Amount</div>
                <div class="value">₹${data.PaidAmount ?? 0}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Balance</div>
                <div class="value">₹${data.Balance ?? 0}</div>
              </div>
            </div>

          </div>

          <div class="section-title">Additional Details</div>
          <div class="row g-3">

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Addiction Type</div>
                <div class="value">${data.AddictionType ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Pickup Type</div>
                <div class="value">${data.PickupType ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Distance (KM)</div>
                <div class="value">${data.DistanceKM ?? "-"}</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="info-box">
                <div class="label">Status</div>
                <div class="value">
                  <span class="status-active">${data.Status ?? "-"}</span>
                </div>
              </div>
            </div>

          </div>
        `;
      }

      function goBack() {
        window.location.href = "patients.html";
      }

      loadPatientDetails();
    </script>
  </body>
</html>
